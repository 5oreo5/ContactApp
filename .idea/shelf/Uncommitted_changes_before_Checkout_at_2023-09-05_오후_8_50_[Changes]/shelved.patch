Index: app/src/main/java/com/android/contectapp/MainActivity.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.android.contectapp\r\n\r\nimport android.content.Intent\r\nimport android.content.pm.PackageManager\r\nimport android.net.Uri\r\nimport androidx.appcompat.app.AppCompatActivity\r\nimport android.os.Bundle\r\nimport android.provider.ContactsContract\r\nimport android.provider.Settings\r\nimport androidx.activity.result.contract.ActivityResultContracts\r\nimport androidx.core.content.ContextCompat\r\nimport androidx.lifecycle.lifecycleScope\r\nimport com.android.contectapp.databinding.ActivityMainBinding\r\nimport com.google.android.material.dialog.MaterialAlertDialogBuilder\r\nimport com.google.android.material.tabs.TabLayoutMediator\r\nimport kotlinx.coroutines.Dispatchers\r\nimport kotlinx.coroutines.launch\r\n\r\nclass MainActivity : AppCompatActivity() {\r\n    private val binding: ActivityMainBinding by lazy { ActivityMainBinding.inflate(layoutInflater)}\r\n    private val tabTextList = listOf(\"detail_page\",\"contacts\", \"my_page\")\r\n    private val tabIconList = listOf(R.drawable.tab_iv_detailpage,R.drawable.tab_iv_contacts,R.drawable.tab_iv_mypage)\r\n    private val requestPermissionLauncher =\r\n        registerForActivityResult(ActivityResultContracts.RequestPermission()) { isGranted ->\r\n            if (isGranted) {\r\n                // READ_CONTACTS 권한이 허용된 경우 연락처 데이터를 불러옴\r\n                loadContacts()\r\n            } else {\r\n                // READ_CONTACTS 권한이 거부된 경우 사용자에게 권한이 필요하다고 알려줄 수 있음\r\n                // 예를 들어, 사용자에게 AlertDialog를 표시하여 권한 요청 메시지를 표시할 수 있음\r\n                showPermissionDeniedDialog()\r\n            }\r\n        }\r\n\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n        super.onCreate(savedInstanceState)\r\n        setContentView(binding.root)\r\n        binding.mainViewPager.adapter = MainAdapter(this)\r\n\r\n        // READ_CONTACTS 권한 확인 및 요청\r\n        if (ContextCompat.checkSelfPermission(\r\n                this,\r\n                android.Manifest.permission.READ_CONTACTS\r\n            ) == PackageManager.PERMISSION_GRANTED\r\n        ) {\r\n            // READ_CONTACTS 권한이 이미 허용된 경우 연락처 데이터를 불러옴\r\n            loadContacts()\r\n        } else {\r\n            // READ_CONTACTS 권한을 요청\r\n            requestPermissionLauncher.launch(android.Manifest.permission.READ_CONTACTS)\r\n        }\r\n\r\n        TabLayoutMediator(binding.mainTabLayout,binding.mainViewPager) { tab, position ->\r\n            tab.text = tabTextList[position]\r\n            tab.setIcon(tabIconList[position])\r\n        }.attach()\r\n    }\r\n\r\n    private fun loadContacts() {\r\n        // 연락처 데이터를 불러오는 작업을 수행\r\n        lifecycleScope.launch(Dispatchers.IO) {\r\n            val cursor = contentResolver.query(\r\n                ContactsContract.Contacts.CONTENT_URI,\r\n                null,\r\n                null,\r\n                null,\r\n                null\r\n            )\r\n\r\n            cursor?.use { cursor ->\r\n                while (cursor.moveToNext()) {\r\n                    val contactName =\r\n                        cursor.getString(cursor.getColumnIndexOrThrow(ContactsContract.Contacts.DISPLAY_NAME))\r\n                    // 연락처 이름을 사용하거나 다른 연락처 정보를 처리할 수 있음\r\n                }\r\n            }\r\n        }\r\n    }\r\n    private fun showPermissionDeniedDialog() {\r\n        MaterialAlertDialogBuilder(this)\r\n            .setTitle(\"권한 필요\")\r\n            .setMessage(\"연락처를 읽기 위해 READ_CONTACTS 권한이 필요합니다. 권한을 부여하려면 설정으로 이동하세요.\")\r\n            .setPositiveButton(\"설정으로 이동\") { _, _ ->\r\n                // 사용자를 앱 설정으로 이동시키는 인텐트를 생성\r\n                val intent = Intent(Settings.ACTION_APPLICATION_DETAILS_SETTINGS)\r\n                val uri = Uri.fromParts(\"package\", packageName, null)\r\n                intent.data = uri\r\n                startActivity(intent)\r\n            }\r\n            .setNegativeButton(\"나중에\") { dialog, _ ->\r\n                dialog.dismiss()\r\n            }\r\n            .show()\r\n    }\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/android/contectapp/MainActivity.kt b/app/src/main/java/com/android/contectapp/MainActivity.kt
--- a/app/src/main/java/com/android/contectapp/MainActivity.kt	(revision dc34f0f8993321cdc650b64f4a0dc4446ef2fa22)
+++ b/app/src/main/java/com/android/contectapp/MainActivity.kt	(date 1693914338652)
@@ -7,6 +7,7 @@
 import android.os.Bundle
 import android.provider.ContactsContract
 import android.provider.Settings
+import android.util.Log
 import androidx.activity.result.contract.ActivityResultContracts
 import androidx.core.content.ContextCompat
 import androidx.lifecycle.lifecycleScope
@@ -72,6 +73,7 @@
                     val contactName =
                         cursor.getString(cursor.getColumnIndexOrThrow(ContactsContract.Contacts.DISPLAY_NAME))
                     // 연락처 이름을 사용하거나 다른 연락처 정보를 처리할 수 있음
+                    Log.d("cursor","통과중입니다~")
                 }
             }
         }
